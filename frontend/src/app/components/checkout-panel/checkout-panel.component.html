<div class="checkout-container">
  <h2>Your Cart</h2>

  <mat-list>
    <mat-list-item *ngFor="let item of checkoutService.getCartItems()">
      <span matListItemTitle>{{ item.product.name }}</span>

      <span matListItemLine>
    {{ item.quantity }} x {{ item.product.unitPrice | currency:'EUR' }}

        <ng-container *ngIf="getDiscountInfo(item.product.name) as detail">
      <span *ngIf="detail.discountApplied" class="price-container">
        <span class="old-price">{{ detail.priceBeforeDiscount | currency:'EUR' }}</span>
        <span class="new-price">{{ detail.priceAfterDiscount | currency:'EUR' }}</span>
        <mat-icon color="accent" style="font-size: 16px; vertical-align: middle;">auto_fix_high</mat-icon>
      </span>
    </ng-container>
  </span>
    </mat-list-item>

    <div *ngIf="checkoutService.getCartItems().length === 0" class="empty-msg">
      Your cart is empty.
    </div>
  </mat-list>

  <mat-divider></mat-divider>

  <div class="actions" *ngIf="checkoutService.getCartItems().length > 0">
    <div *ngIf="totalPrice !== null" class="total-result">
      <h3>Total to Pay: {{ totalPrice | currency:'EUR' }}</h3>
      <p class="offer-note">* Offers applied by backend</p>
    </div>

    <div class="button-group">
      <button mat-flat-button color="primary" (click)="onCheckout()">
        Checkout
      </button>
      <button mat-stroked-button color="warn" (click)="onClear()">
        Clear
      </button>
    </div>
  </div>

  <p *ngIf="errorMessage" class="error">{{ errorMessage }}</p>
</div>
